<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§å…åŠŸèƒ½æµ‹è¯• - é‡‘çŒªåˆ·æ–°ç›‘æ§ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/firebase-collaboration.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #f39c12;
            margin: 0;
        }
        
        .test-section {
            margin: 25px 0;
            padding: 20px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            background: #f8f9fa;
        }
        
        .test-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
        }
        
        .test-btn {
            background: #f39c12;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 150px;
        }
        
        .test-btn:hover {
            background: #e67e22;
            transform: translateY(-2px);
        }
        
        .test-btn.primary {
            background: #27ae60;
        }
        
        .test-btn.primary:hover {
            background: #219a52;
        }
        
        .test-btn.danger {
            background: #e74c3c;
        }
        
        .test-btn.danger:hover {
            background: #c0392b;
        }
        
        .status-display {
            background: white;
            border: 2px solid #f39c12;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 8px 0;
            padding: 5px 0;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .status-item:last-child {
            border-bottom: none;
        }
        
        .status-label {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .status-value {
            color: #f39c12;
            font-family: monospace;
        }
        
        .instructions {
            background: #e8f4fd;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .instructions h3 {
            margin-top: 0;
            color: #2980b9;
        }
        
        .instructions ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .instructions li {
            margin: 8px 0;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ›ï¸ å¤§å…åŠŸèƒ½æµ‹è¯•</h1>
            <p>æµ‹è¯•å…¨çƒåä½œå¤§å…çš„åŠŸèƒ½</p>
        </div>
        
        <div class="instructions">
            <h3>ğŸ“‹ ä½¿ç”¨è¯´æ˜</h3>
            <ol>
                <li><strong>æ‰“å¼€ä¸»é¡µé¢</strong> - åœ¨å¦ä¸€ä¸ªæ ‡ç­¾é¡µä¸­æ‰“å¼€ä¸»é¡µé¢ (index.html)</li>
                <li><strong>ç‚¹å‡»åä½œæŒ‰é’®</strong> - åœ¨ä¸»é¡µé¢ä¸­ç‚¹å‡»åä½œç›¸å…³æŒ‰é’®</li>
                <li><strong>åŠ å…¥å¤§å…</strong> - é€‰æ‹©"åŠ å…¥å…¨çƒå¤§å…"é€‰é¡¹</li>
                <li><strong>æµ‹è¯•åä½œ</strong> - åœ¨è¡¨æ ¼ä¸­è¿›è¡Œæ“ä½œï¼Œè§‚å¯Ÿå®æ—¶åŒæ­¥æ•ˆæœ</li>
                <li><strong>ç¦»å¼€å¤§å…</strong> - æµ‹è¯•ç¦»å¼€å¤§å…æ—¶çš„æ•°æ®åˆå¹¶é€‰é¡¹</li>
            </ol>
            <p><strong>æ³¨æ„ï¼š</strong>éœ€è¦åœ¨ä¸»é¡µé¢ä¸­è¿›è¡Œå®é™…æµ‹è¯•ï¼Œæ­¤é¡µé¢åªæ˜¯åŠŸèƒ½æ¼”ç¤ºå’ŒçŠ¶æ€ç›‘æ§ã€‚</p>
        </div>
        
        <div class="test-section">
            <h3>ğŸ›ï¸ å¿«é€Ÿæµ‹è¯•</h3>
            <div class="test-buttons">
                <button class="test-btn" onclick="openMainPage()">
                    ğŸ  æ‰“å¼€ä¸»é¡µé¢
                </button>
                <button class="test-btn primary" onclick="testJoinHall()">
                    ğŸ›ï¸ æµ‹è¯•åŠ å…¥å¤§å…
                </button>
                <button class="test-btn danger" onclick="testLeaveHall()">
                    ğŸšª æµ‹è¯•ç¦»å¼€å¤§å…
                </button>
            </div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“Š å½“å‰çŠ¶æ€</h3>
            <div class="status-display" id="status-display">
                <div class="status-item">
                    <span class="status-label">FirebaseçŠ¶æ€:</span>
                    <span class="status-value" id="firebase-status">æ£€æŸ¥ä¸­...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">å¤§å…çŠ¶æ€:</span>
                    <span class="status-value" id="hall-status">æœªè¿æ¥</span>
                </div>
                <div class="status-item">
                    <span class="status-label">å…¨å±€å‡½æ•°:</span>
                    <span class="status-value" id="function-status">æ£€æŸ¥ä¸­...</span>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“ æµ‹è¯•æ—¥å¿—</h3>
            <div id="log-output" style="background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto;">
                åˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿ...<br>
            </div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ›ï¸ å¤§å…åŠŸèƒ½è¯´æ˜</h3>
            <ul>
                <li><strong>å…¨çƒåä½œ:</strong> æ‰€æœ‰åŠ å…¥å¤§å…çš„ç”¨æˆ·å…±åŒç¼–è¾‘åŒä¸€ä¸ªè¡¨æ ¼</li>
                <li><strong>å®æ—¶åŒæ­¥:</strong> ä¸€ä¸ªç”¨æˆ·çš„æ“ä½œä¼šå®æ—¶åŒæ­¥åˆ°æ‰€æœ‰å…¶ä»–ç”¨æˆ·</li>
                <li><strong>æ•°æ®ä¿æŠ¤:</strong> è¿›å…¥å¤§å…å‰ä¼šè‡ªåŠ¨å¤‡ä»½æœ¬åœ°æ•°æ®</li>
                <li><strong>æ™ºèƒ½åˆå¹¶:</strong> ç¦»å¼€å¤§å…æ—¶å¯é€‰æ‹©åˆå¹¶å¤§å…æ•°æ®æˆ–æ¢å¤æœ¬åœ°æ•°æ®</li>
                <li><strong>å†²çªå¤„ç†:</strong> é¿å…æœ¬åœ°å·²ç¼–è¾‘çš„è¡¨æ ¼ä¸å¤§å…æ•°æ®å‘ç”Ÿå†²çª</li>
            </ul>
        </div>
    </div>

    <script>
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logOutput = document.getElementById('log-output');
            logOutput.innerHTML += `<span style="color: #74b9ff;">[${timestamp}]</span> ${message}<br>`;
            logOutput.scrollTop = logOutput.scrollHeight;
            console.log(message);
        }
        
        function updateStatus() {
            // æ£€æŸ¥FirebaseçŠ¶æ€
            const firebaseStatus = document.getElementById('firebase-status');
            if (typeof window.firebaseApp !== 'undefined') {
                firebaseStatus.textContent = 'âœ… å·²åŠ è½½';
                firebaseStatus.style.color = '#27ae60';
            } else {
                firebaseStatus.textContent = 'âŒ æœªåŠ è½½';
                firebaseStatus.style.color = '#e74c3c';
            }
            
            // æ£€æŸ¥å…¨å±€å‡½æ•°
            const functionStatus = document.getElementById('function-status');
            const hasJoinHall = typeof window.joinHall === 'function';
            const hasLeaveHall = typeof window.leaveHall === 'function';
            
            if (hasJoinHall && hasLeaveHall) {
                functionStatus.textContent = 'âœ… å¯ç”¨';
                functionStatus.style.color = '#27ae60';
            } else {
                functionStatus.textContent = 'âŒ ä¸å¯ç”¨';
                functionStatus.style.color = '#e74c3c';
            }
            
            log('çŠ¶æ€æ›´æ–°å®Œæˆ');
        }
        
        function openMainPage() {
            log('ğŸ  æ‰“å¼€ä¸»é¡µé¢...');
            window.open('index.html', '_blank');
        }
        
        function testJoinHall() {
            log('ğŸ›ï¸ æµ‹è¯•åŠ å…¥å¤§å…åŠŸèƒ½...');
            
            if (typeof window.joinHall === 'function') {
                try {
                    window.joinHall();
                    log('âœ… joinHallå‡½æ•°è°ƒç”¨æˆåŠŸ');
                } catch (error) {
                    log('âŒ joinHallå‡½æ•°è°ƒç”¨å¤±è´¥: ' + error.message);
                }
            } else {
                log('âŒ joinHallå‡½æ•°ä¸å­˜åœ¨ï¼Œè¯·å…ˆåœ¨ä¸»é¡µé¢ä¸­åˆå§‹åŒ–');
                alert('è¯·å…ˆåœ¨ä¸»é¡µé¢(index.html)ä¸­åˆå§‹åŒ–åº”ç”¨ï¼Œç„¶åå†æµ‹è¯•å¤§å…åŠŸèƒ½');
            }
        }
        
        function testLeaveHall() {
            log('ğŸšª æµ‹è¯•ç¦»å¼€å¤§å…åŠŸèƒ½...');
            
            if (typeof window.leaveHall === 'function') {
                try {
                    window.leaveHall();
                    log('âœ… leaveHallå‡½æ•°è°ƒç”¨æˆåŠŸ');
                } catch (error) {
                    log('âŒ leaveHallå‡½æ•°è°ƒç”¨å¤±è´¥: ' + error.message);
                }
            } else {
                log('âŒ leaveHallå‡½æ•°ä¸å­˜åœ¨ï¼Œè¯·å…ˆåœ¨ä¸»é¡µé¢ä¸­åˆå§‹åŒ–');
                alert('è¯·å…ˆåœ¨ä¸»é¡µé¢(index.html)ä¸­åˆå§‹åŒ–åº”ç”¨ï¼Œç„¶åå†æµ‹è¯•å¤§å…åŠŸèƒ½');
            }
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸ¯ å¤§å…åŠŸèƒ½æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            updateStatus();
            
            // å®šæœŸæ›´æ–°çŠ¶æ€
            setInterval(updateStatus, 5000);
        });
        
        // ç›‘å¬æ¥è‡ªä¸»é¡µé¢çš„æ¶ˆæ¯
        window.addEventListener('message', function(event) {
            if (event.data.type === 'hall_status_update') {
                const hallStatus = document.getElementById('hall-status');
                if (event.data.isInHall) {
                    hallStatus.textContent = 'âœ… å·²è¿æ¥';
                    hallStatus.style.color = '#27ae60';
                    log('ğŸ“¡ æ¥æ”¶åˆ°å¤§å…çŠ¶æ€æ›´æ–°: å·²è¿æ¥');
                } else {
                    hallStatus.textContent = 'âŒ æœªè¿æ¥';
                    hallStatus.style.color = '#e74c3c';
                    log('ğŸ“¡ æ¥æ”¶åˆ°å¤§å…çŠ¶æ€æ›´æ–°: æœªè¿æ¥');
                }
            }
        });
    </script>
</body>
</html>
